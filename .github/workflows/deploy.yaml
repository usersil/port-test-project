name: Self-Service Workflow

on:
  repository_dispatch:
    types:
      - self_service_triggered

jobs:
  self_service_job:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: Generate YAML
        run: |
          # Replace this with your script to generate the YAML content
          echo "This is a sample YAML file generated by the workflow" > generated.yaml
          
      - name: Commit and push changes
        run: |
          git config user.name "usersil"
          git config user.email "silpa.suresh@accenture.com"
          git add generated.yaml
          git commit -m "Generate YAML file"
          git remote add origin_with_token https://$GITHUB_ACTOR:${{ secrets.PAT}}@github.com/usersil/port-test-project.git
          git push

          
      # - name: Install ArgoCD CLI
      #   run: |
      #     curl -LO https://github.com/argoproj/argo-cd/releases/download/v2.1.5/argocd-linux-amd64
      #     chmod +x argocd-linux-amd64
      #     sudo mv argocd-linux-amd64 /usr/local/bin/argocd

      # - name: Login to ArgoCD
      #   run: argocd login --username "admin" --password "3n9rn8SHGS3csUXt" --server http://a643e055e05314dfa8ab628ed545b9f7-783703239.us-east-1.elb.amazonaws.com

     
